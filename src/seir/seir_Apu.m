function Apu = seir_Apu(u,nP,it)
% -----------------------------------------------------------------------------
% diego domenzain
% spring 2020 while at Colorado School of Mines
% ------------------------------------------------------------------------------
% inversion of the SEIR model using the adjoint method.
% this function computes the derivative of A wrt p times u.
% ------------------------------------------------------------------------------
% b = p(1);
% a = p(2);
% g = p(3);
% d = p(4);
% l = p(5);
% k = p(6);
% ------------------------------------------------------------------------------
Apu      = zeros(7,6);
% ------------------------------------------------------------------------------
Apu(1,1) = -(u(it,3)/nP)*u(it,1);
Apu(2,1) =  (u(it,3)/nP)*u(it,1);
% ------------------------------------------------------------------------------
Apu(1,2) =  -u(it,1);
Apu(7,2) =   u(it,1);
% ------------------------------------------------------------------------------
Apu(2,3) =  -u(it,2);
Apu(3,3) =   u(it,2);
% ------------------------------------------------------------------------------
Apu(3,4) =  -u(it,3);
Apu(4,4) =   u(it,3);
% ------------------------------------------------------------------------------
Apu(4,5) =  -u(it,4);
Apu(5,5) =   u(it,4);
% ------------------------------------------------------------------------------
Apu(4,6) =  -u(it,4);
Apu(6,6) =   u(it,4);
% ------------------------------------------------------------------------------
end