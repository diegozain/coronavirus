function Apu = sir_Apu(u,nP,it)
% -----------------------------------------------------------------------------
% diego domenzain
% spring 2020 while at Colorado School of Mines
% ------------------------------------------------------------------------------
% inversion of the SIR model using the adjoint method.
% this function computes the derivative of A wrt p times u.
% ------------------------------------------------------------------------------
% b = p(1);
% g = p(2);
% ------------------------------------------------------------------------------
Apu      = zeros(3,2);
% ------------------------------------------------------------------------------
Apu(1,1) = -(u(it,2)/nP)*u(it,1);
Apu(2,1) =  (u(it,2)/nP)*u(it,1);
% ------------------------------------------------------------------------------
Apu(2,2) =  -u(it,2);
Apu(3,2) =   u(it,2);
% ------------------------------------------------------------------------------
end