function A = sir_A(u,p,nP,it)
% -----------------------------------------------------------------------------
% diego domenzain
% spring 2020 while at Colorado School of Mines
% ------------------------------------------------------------------------------
% inversion of the SEIR model using the adjoint method.
% this function computes the A matrix.
% ------------------------------------------------------------------------------
b = p(1);                % infection rate 
g = p(2);                % inverse of average latent time 
% ------------------------------------------------------------------------------
A      = zeros(3,3);
% ------------------------------------------------------------------------------
A(1,1) = -(b*u(it,2)/nP);
A(2,1) =   b*u(it,2)/nP;
A(2,2) = -g;
A(3,2) =  g;
% ------------------------------------------------------------------------------
end